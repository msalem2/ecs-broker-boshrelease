---
name: ecs-broker
product_version: 1.5.0
label: Ecs Service Broker Experimental
rank: 50
metadata_version: '1.5'
icon_image: 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
serial: true
releases:
- name: ecs_broker
  version: '1.5'
  file: ecs_broker-1.5.tgz
stemcell_criteria:
  os: ubuntu-trusty
  version: '3026'
  requires_cpi: false
property_blueprints:
- name: encryption_key
  type: secret
- name: vm_credentials
  type: salted_credentials
  default:
    identity: vcap
- name: app_name
  type: string
  configurable: true
  default: EcsServiceBroker
- name: app_version
  type: string
  configurable: true
  default: v1
- name: app_uri
  type: string
  configurable: true
  default: ecs-broker
- name: create_open_security_group
  type: boolean
  configurable: true
  default: false
- name: enable_global_access_to_plans
  type: boolean
  configurable: true
  default: false
- name: managementEndpoint
  type: url
  configurable: true
- name: objectEndpoint
  type: url
  configurable: true
- name: baseUrl
  type: string
  configurable: true
- name: repositoryEndpoint
  type: url
  configurable: true
- name: replicationGroup
  type: string
  configurable: true
- name: namespace
  type: string
  configurable: true
- name: repositoryUser
  type: string
  configurable: true
  default: 'repository'
- name: repositoryBucket
  type: string
  configurable: true
  default: 'repository'
- name: username
  type: string
  configurable: true
  default: 'root'
- name: password
  type: string
  configurable: true
  default: 'ChangeMe'
- name: prefix
  type: string
  configurable: true
  default: 'ecs-cf-broker-'
- name: brokerApiVersion
  type: string
  configurable: true
  default: '2.8'
### CUSTOM_VARIABLE_DEFN_END_MARKER
- name: org_quota
  type: integer
  configurable: false
  constraints:
    min: 512
    max: 1024
  default: 512
- name: memory
  type: integer
  configurable: false
  constraints:
    min: 256
    max: 1024
  default: 256
- name: internal_service_names
  type: string
  configurable: false
  default: "ecs-bucket"
- name: persistence_store_type
  type: none
  configurable: false
#   options:
#   - name: mysql
#     label: Managed MySQL Service
#     default: true
#   - name: custom
#     label: User specified Persistent Store
#   - name: none
#     label: None


### ON_DEMAND_PLAN_BEGIN_MARKER
- name: on_demand_service_plans_collection
  type: collection
  configurable: true

  # Needs to have its own inner/nested property_blueprints when its a collection
  property_blueprints:
  - name: guid
    type: uuid
    optional: false
    unique: true
  - name: plan_name
    type: string
    configurable: true
  - name: plan_description
    type: string
    configurable: true
  - name: quota-limit
    type: integer
    configurable: true
  - name: quota-warning
    type: integer
    configurable: true

### ON_DEMAND_PLAN_END_MARKER

form_types:
- property_inputs:
  - reference: .properties.app_name
    label: Service Broker Application Name
    description: 'Enter the name for the Service Broker App'
  - reference: .properties.app_version
    label: Service Broker Application version
    description: 'Enter the version of the Service Broker App (Final app name would include app version like ${appName}-${appversion}'
  - reference: .properties.app_uri
    label: Service Broker Application URI
    description: 'Enter the uri/endpoint for the Service Broker app (on push to CF)'
  - reference: .properties.create_open_security_group
    label: Open up Security Groups
    description: 'Open up security group on CF for Service Broker to access other apps or CF Cloud Controller'
  - reference: .properties.enable_global_access_to_plans
    label: Enable Global access to all Services and Plans
    description: 'Open up access to all service plans across all orgs and spaces'
  - reference: .properties.managementEndpoint
    label: ECS Management Endpoint
    description: 'Enter the uri/endpoint for the ECS HTTPS management API'
  - reference: .properties.objectEndpoint
    label: ECS Object Endpoint
    description: '(Optional) Enter the uri/endpoint for the ECS S3 API.  Not needed the base URL endpoint should be used.'
  - reference: .properties.baseUrl
    label: ECS Base URL
    description: 'Enter the name of the ECS configured base URL that should be used with bucket credentials.'
  - reference: .properties.repositoryEndpoint
    label: Repository Endpoint
    description: '(Optional) Enter the uri/endpoint for the ECS S3 API that should be used for persisting broker metadata.  Defaults to the object endpoint or base url.'
  - reference: .properties.replicationGroup
    label: Replication Group
    description: 'Enter the ID of the ECS replication group to be used for created buckets.'
  - reference: .properties.namespace
    label: Namespace
    description: 'Enter the name of the ECS namespace to be used for created buckets and users.'
  - reference: .properties.repositoryUser
    label: Repository User
    description: '(Optional) Enter the name of the user that should be created/used for managing broker metadata.  Defaults to "repository".'
  - reference: .properties.repositoryBucket
    label: Repository Bucket
    description: '(Optional) Enter the name of the bucket that should be created/used for managing broker metadata.  Defaults to "repository".'
  - reference: .properties.username
    label: ECS Username
    description: '(Optional) Enter the name of the ECS Management API user.  Defaults to "root".'
  - reference: .properties.password
    label: ECS Password
    description: '(Optional) Enter the ECS Management API password.  Defaults to "ChangeMe"'
  - reference: .properties.prefix
    label: ECS Repository Prefix
    description: '(Optional) Enter a string used to prefix broker created buckets and users.  Defaults to "ecs-cf-repository-"'
  name: ecs_broker_app
  label: Service Broker Application
  description: Service Broker configuration

  ### ON_DEMAND_PLAN_BEGIN_MARKER
- property_inputs:
  - reference: .properties.on_demand_service_plans_collection
    label: On-Demand Service Plans
    property_inputs:
    - reference: plan_name
      label: Plan Name
      description: "Name of Plan"
      slug: false
    - reference: plan_description
      label: Plan Description
      description: "Description of Plan"
      slug: false
    - reference: plan_details
      label: "Plan Details or bullets (individual line entries, each with Name : Value : Description and ending with ;)"
      description: "Specify configurations or bullets for the plan. Specify each plan detail or bullet in a separate line with a name, value, description separated by ':' and ending with ';'.
      Detail1: associated value : description ; <NEWLINE> Detail2: its value : description <NEWLINE>"
      slug: false
  name: on_demand_service_plans
  label: On-Demand Service Plans
  description: "An on-demand service plan lets Pivotal CF users create their own Service Plans from the Pivotal CF command line interface or developer console. Use this page to configure the service plan's settings."
  ### ON_DEMAND_PLAN_END_MARKER

 name: deploy-service-broker
  resource_label: Deploy Ecs Service Broker
  errand: true
  templates:
  - name: deploy-service-broker
    release: ecs_broker
  resource_definitions:
  - name: ram
    type: integer
    configurable: false
    default: 512
  - name: ephemeral_disk
    type: integer
    configurable: false
    default: 2048
  - name: persistent_disk
    type: integer
    configurable: false
    default: 0
  - name: cpu
    type: integer
    configurable: false
    default: 1
  static_ip: 0
  dynamic_ip: 1
  max_in_flight: 1
  instance_definitions:
  - name: instances
    type: integer
    configurable: false
    default: 1
  property_blueprints:
  - name: vm_credentials
    type: salted_credentials
    default:
      identity: vcap
  - name: broker_credentials
    type: salted_credentials

  manifest: |
    domain: (( ..cf.cloud_controller.system_domain.value ))
    app_domains:
      - (( ..cf.cloud_controller.apps_domain.value ))
    ssl:
      skip_cert_verify: (( ..cf.ha_proxy.skip_cert_verify.value ))
    uaa:
      url: https://uaa.(( ..cf.cloud_controller.system_domain.value ))
      clients:
        ecs_broker:
          secret: test
    ecs_broker:
      app_name: (( .properties.app_name.value ))
      app_version: (( .properties.app_version.value ))
      app_uri: (( .properties.app_uri.value ))
      create_open_security_group: (( .properties.create_open_security_group.value ))
      app_push:
        org_quota: (( .properties.org_quota.value ))
        timeout: 180
        memory: (( .properties.memory.value ))
      managementEndpoint: (( .properties.managementEndpoint.value ))
      objectEndpoint: (( .properties.objectEndpoint.value ))
      baseUrl: (( .properties.baseUrl.value ))
      repositoryEndpoint: (( .properties.repositoryEndpoint.value ))
      replicationGroup: (( .properties.replicationGroup.value ))
      namespace: (( .properties.namespace.value ))
      repositoryUser: (( .properties.repositoryUser.value ))
      repositoryBucket: (( .properties.repositoryBucket.value ))
      username: (( .properties.username.value ))
      password: (( .properties.password.value ))
      prefix: (( .properties.prefix.value ))
      securityUser: user
      securityPassword: password   
      certificate: (( .properties.certificate.value ))
      persistence_store_type: none


      ### ON_DEMAND_PLAN_BEGIN_MARKER
      on_demand_service_plans: (( .properties.on_demand_service_plans_collection.value ))
      ### ON_DEMAND_PLAN_END_MARKER
      encryption_key: (( .properties.encryption_key.value ))
      cf:
        admin_user: (( ..cf.uaa.system_services_credentials.identity ))
        admin_password: (( ..cf.uaa.system_services_credentials.password ))
      broker:
        user: (( .deploy-service-broker.broker_credentials.identity ))
        password: (( .deploy-service-broker.broker_credentials.password ))
        internal_service_names: (( .properties.internal_service_names.value ))

- name: register-broker
  resource_label: Register Ecs Service Broker
  templates:
  - name: register-broker
    release: ecs_broker
  errand: true
  resource_definitions:
  - name: ram
    type: integer
    configurable: false
    default: 512
  - name: ephemeral_disk
    type: integer
    configurable: false
    default: 2048
  - name: persistent_disk
    type: integer
    configurable: false
    default: 0
  - name: cpu
    type: integer
    configurable: false
    default: 1
  static_ip: 0
  dynamic_ip: 1
  max_in_flight: 1
  instance_definitions:
  - name: instances
    type: integer
    configurable: false
    default: 1
  property_blueprints:
  - name: vm_credentials
    type: salted_credentials
    default:
      identity: vcap

  manifest: |
    domain: (( ..cf.cloud_controller.system_domain.value ))
    app_domains:
      - (( ..cf.cloud_controller.apps_domain.value ))
    ssl:
      skip_cert_verify: (( ..cf.ha_proxy.skip_cert_verify.value ))
    uaa:
      url: https://uaa.(( ..cf.cloud_controller.system_domain.value ))
      clients:
        ecs_broker:
          secret: test
    ecs_broker:
      app_name: (( .properties.app_name.value ))
      app_version: (( .properties.app_version.value ))
      app_uri: (( .properties.app_uri.value ))
      encryption_key: (( .properties.encryption_key.value ))
      enable_global_access_to_plans: (( .properties.enable_global_access_to_plans.value ))
      cf:
        admin_user: (( ..cf.uaa.system_services_credentials.identity ))
        admin_password: (( ..cf.uaa.system_services_credentials.password ))
      broker:
        user: (( .deploy-service-broker.broker_credentials.identity ))
        password: (( .deploy-service-broker.broker_credentials.password ))
        internal_service_names: (( .properties.internal_service_names.value ))

- name: destroy-broker
  resource_label: Remove Ecs Service Broker
  templates:
  - name: destroy-broker
    release: ecs_broker
  errand: true
  resource_definitions:
  - name: ram
    type: integer
    configurable: false
    default: 512
  - name: ephemeral_disk
    type: integer
    configurable: false
    default: 1024
  - name: persistent_disk
    type: integer
    configurable: false
    default: 0
  - name: cpu
    type: integer
    configurable: false
    default: 1
  static_ip: 0
  dynamic_ip: 1
  max_in_flight: 1
  instance_definitions:
  - name: instances
    type: integer
    configurable: false
    default: 1
  property_blueprints:
  - name: vm_credentials
    type: salted_credentials
    default:
      identity: vcap

  manifest: |
    domain: (( ..cf.cloud_controller.system_domain.value ))
    app_domains:
      - (( ..cf.cloud_controller.apps_domain.value ))
    ssl:
      skip_cert_verify: (( ..cf.ha_proxy.skip_cert_verify.value ))
    uaa:
      url: https://uaa.(( ..cf.cloud_controller.system_domain.value ))
      clients:
        ecs_broker:
          secret: test
    ecs_broker:
      app_name: (( .properties.app_name.value ))
      app_version: (( .properties.app_version.value ))
      app_uri: (( .properties.app_uri.value ))
      encryption_key: (( .properties.encryption_key.value ))
      cf:
        admin_user: (( ..cf.uaa.system_services_credentials.identity ))
        admin_password: (( ..cf.uaa.system_services_credentials.password ))
      broker:
        user: (( .deploy-service-broker.broker_credentials.identity ))
        password: (( .deploy-service-broker.broker_credentials.password ))
        internal_service_names: (( .properties.internal_service_names.value ))

- name: compilation
  resource_label: compilation
  resource_definitions:
   - name: ram
     type: integer
     configurable: true
     default: 1_024
   - name: ephemeral_disk
     type: integer
     configurable: true
     default: 1024
   - name: persistent_disk
     type: integer
     configurable: true
     default: 0
   - name: cpu
     type: integer
     configurable: true
     default: 2

  static_ip: 0
  dynamic_ip: 1
  max_in_flight: 1

  instance_definitions:
    - name: instances
      type: integer
      default: 1

update:
  canaries: 1
  canary_watch_time: 60000-240000
  max_in_flight: 1
  update_watch_time: 60000-240000

requires_product_versions:
- name: cf
  version: "~> 1.0"
provides_product_versions:
- name: ecs_broker
  version: '1.5'
post_deploy_errands:
- name: deploy-service-broker
- name: register-broker
pre_delete_errands:
- name: destroy-broker

